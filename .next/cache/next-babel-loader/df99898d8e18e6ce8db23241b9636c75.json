{"ast":null,"code":"import _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nvar _jsxFileName = \"D:\\\\programming\\\\Reactjs_Nextjs_sample\\\\reactjs_nextjs_firebase_addressbook\\\\components\\\\Fireadd.js\";\nimport React, { Component } from 'react';\nimport firebase from \"firebase\";\nimport Router from 'next/router';\nimport \"firebase/storage\";\n\nvar Fireadd =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Fireadd, _Component);\n\n  function Fireadd(props) {\n    var _this;\n\n    _classCallCheck(this, Fireadd);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Fireadd).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_this), \"style\", {\n      fontSize: \"12pt\",\n      padding: \"5px 10px\" // 初期化処理\n\n    });\n\n    _this.state = {\n      name_str: '',\n      msg_str: '',\n      lastID: -1,\n      data: []\n    };\n\n    _this.getLastID(); // 最後のIDのチェック\n\n\n    _this.doChangeName = _this.doChangeName.bind(_assertThisInitialized(_this));\n    _this.doChangeMsg = _this.doChangeMsg.bind(_assertThisInitialized(_this));\n    _this.doAction = _this.doAction.bind(_assertThisInitialized(_this));\n    return _this;\n  }\n\n  _createClass(Fireadd, [{\n    key: \"doChangeName\",\n    value: function doChangeName(e) {\n      this.setState({\n        name_str: e.target.value\n      });\n    }\n  }, {\n    key: \"doChangeMsg\",\n    value: function doChangeMsg(e) {\n      this.setState({\n        msg_str: e.target.value\n      });\n    }\n  }, {\n    key: \"doAction\",\n    value: function doAction(e) {\n      this.addFireData();\n      Router.push('/fire');\n    } // 最後のIDを取得\n\n  }, {\n    key: \"getLastID\",\n    value: function getLastID() {\n      var db = firebase.database();\n      var ref = db.ref('sample/');\n      var self = this;\n      ref.orderByKey().limitToLast(1).on('value', function (snapshot) {\n        var res = snapshot.val();\n\n        for (var i in res) {\n          self.setState({\n            lastID: i\n          });\n          return;\n        }\n      });\n    } // データを追加する\n\n  }, {\n    key: \"addFireData\",\n    value: function addFireData() {\n      if (this.state.lastID == -1) {\n        return;\n      }\n\n      var id = this.state.lastID * 1 + 1;\n      var db = firebase.database();\n      var ref = db.ref('sample/' + id);\n      ref.set({\n        ID: id,\n        message: this.state.msg_str,\n        name: this.state.name_str\n      });\n    } // レンダリング\n\n  }, {\n    key: \"render\",\n    value: function render() {\n      if (this.state.lastID == -1) {\n        this.getLastID();\n      }\n\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 88\n        },\n        __self: this\n      }, this.state.lastID == -1 ? React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 91\n        },\n        __self: this\n      }, \"please wait...\") : React.createElement(\"table\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 93\n        },\n        __self: this\n      }, React.createElement(\"tbody\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 94\n        },\n        __self: this\n      }, React.createElement(\"tr\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 95\n        },\n        __self: this\n      }, React.createElement(\"th\", {\n        className: \"label\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 96\n        },\n        __self: this\n      }, \"name\"), React.createElement(\"td\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 97\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        type: \"text\",\n        placeholder: \"your name.\",\n        onChange: this.doChangeName,\n        value: this.state.name_str,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 97\n        },\n        __self: this\n      }))), React.createElement(\"tr\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 101\n        },\n        __self: this\n      }, React.createElement(\"th\", {\n        className: \"label\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 102\n        },\n        __self: this\n      }, \"message\"), React.createElement(\"td\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 103\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        type: \"text\",\n        size: \"40\",\n        placeholder: \"type message...\",\n        onChange: this.doChangeMsg,\n        value: this.state.msg_str,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 103\n        },\n        __self: this\n      }))), React.createElement(\"tr\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 108\n        },\n        __self: this\n      }, React.createElement(\"th\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 108\n        },\n        __self: this\n      }), React.createElement(\"td\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 108\n        },\n        __self: this\n      }, React.createElement(\"button\", {\n        onClick: this.doAction,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 109\n        },\n        __self: this\n      }, \"Add\"))))));\n    }\n  }]);\n\n  return Fireadd;\n}(Component);\n\nexport default Fireadd;","map":{"version":3,"sources":["D:\\programming\\Reactjs_Nextjs_sample\\reactjs_nextjs_firebase_addressbook\\components\\Fireadd.js"],"names":["React","Component","firebase","Router","Fireadd","props","fontSize","padding","state","name_str","msg_str","lastID","data","getLastID","doChangeName","bind","doChangeMsg","doAction","e","setState","target","value","addFireData","push","db","database","ref","self","orderByKey","limitToLast","on","snapshot","res","val","i","id","set","ID","message","name"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\r\nimport firebase from \"firebase\";\r\nimport Router from 'next/router';\r\nimport \"firebase/storage\";\r\n\r\n\r\nclass Fireadd extends Component {\r\n    style = {\r\n        fontSize: \"12pt\",\r\n        padding: \"5px 10px\"\r\n    }\r\n\r\n\r\n    // 初期化処理\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            name_str: '',\r\n            msg_str: '',\r\n            lastID: -1,\r\n            data: []\r\n        }\r\n        this.getLastID(); // 最後のIDのチェック\r\n        this.doChangeName = this.doChangeName.bind(this);\r\n        this.doChangeMsg = this.doChangeMsg.bind(this);\r\n        this.doAction = this.doAction.bind(this);\r\n    }\r\n\r\n\r\n    doChangeName(e) {\r\n        this.setState({\r\n            name_str: e.target.value\r\n        })\r\n    }\r\n    doChangeMsg(e) {\r\n        this.setState({\r\n            msg_str: e.target.value\r\n        })\r\n    }\r\n\r\n\r\n    doAction(e) {\r\n        this.addFireData();\r\n        Router.push('/fire');\r\n    }\r\n\r\n\r\n    // 最後のIDを取得\r\n    getLastID() {\r\n        let db = firebase.database();\r\n        let ref = db.ref('sample/');\r\n        let self = this;\r\n        ref.orderByKey()\r\n            .limitToLast(1)\r\n            .on('value', (snapshot) => {\r\n                let res = snapshot.val();\r\n                for (let i in res) {\r\n                    self.setState({\r\n                        lastID: i\r\n                    });\r\n                    return;\r\n                }\r\n            });\r\n    }\r\n\r\n\r\n    // データを追加する\r\n    addFireData() {\r\n        if (this.state.lastID == -1) {\r\n            return;\r\n        }\r\n        let id = this.state.lastID * 1 + 1;\r\n        let db = firebase.database();\r\n        let ref = db.ref('sample/' + id);\r\n        ref.set({\r\n            ID: id,\r\n            message: this.state.msg_str,\r\n            name: this.state.name_str\r\n        });\r\n    }\r\n\r\n\r\n    // レンダリング\r\n    render() {\r\n        if (this.state.lastID == -1) {\r\n            this.getLastID();\r\n        }\r\n        return (<div>\r\n            {(this.state.lastID == -1)\r\n                ?\r\n                <p>please wait...</p>\r\n                :\r\n                <table>\r\n                    <tbody>\r\n                        <tr>\r\n                            <th className=\"label\">name</th>\r\n                            <td><input type=\"text\" placeholder=\"your name.\"\r\n                                onChange={this.doChangeName}\r\n                                value={this.state.name_str} /></td>\r\n                        </tr>\r\n                        <tr>\r\n                            <th className=\"label\">message</th>\r\n                            <td><input type=\"text\" size=\"40\"\r\n                                placeholder=\"type message...\"\r\n                                onChange={this.doChangeMsg}\r\n                                value={this.state.msg_str} /></td>\r\n                        </tr>\r\n                        <tr><th></th><td>\r\n                            <button onClick={this.doAction}>Add</button>\r\n                        </td></tr>\r\n                    </tbody>\r\n                </table>\r\n            }\r\n        </div>)\r\n    }\r\n}\r\n\r\n\r\nexport default Fireadd;\r\n"]},"metadata":{},"sourceType":"module"}